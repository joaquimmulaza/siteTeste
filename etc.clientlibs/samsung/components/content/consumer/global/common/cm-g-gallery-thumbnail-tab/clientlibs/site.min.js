(function(){var d=window.sg.common.$q,h=window.sg.common.video,f=window.sg.common.constants.KEY_CODE,k=window.sg.common.constants.BREAKPOINTS,g=window.sg.common.utils,m=window.sg.common.lazyLoad,b=function(a){this.selector={tabItem:".gallery-thumbnail-tab__item",tabNavItem:".gallery-thumbnail-tab__nav-item",videoWrap:".gallery-thumbnail-tab__video-wrap",video:"div.video",videoPlayBtn:".gallery-thumbnail-tab__play-button",popCloseBtn:".gallery-thumbnail-tab__close",activeCls:"gallery-thumbnail-tab--active",
videoShowCls:"video-active",hideCls:"hide-item"};this.el={window:d(window),component:d(a)};this.handler={resize:this.resize.bind(this),focusLock:function(a){a.keyCode===f.TAB&&(this.focusLast.target[0]===document.activeElement&&!1===a.shiftKey?(a.preventDefault(),this.focusPopup.focus()):this.focusPopup.target[0]===document.activeElement&&!0===a.shiftKey&&(a.preventDefault(),this.focusLast.focus()))}.bind(this)};b.instances.set(a,this);this.setElement();this.init()};b.prototype.setElement=function(){this.el.tabItem=
this.el.component.find(this.selector.tabItem);this.el.tabNavItem=this.el.component.find(this.selector.tabNavItem);this.el.videoPlayBtn=this.el.component.find(this.selector.videoPlayBtn);this.el.videoWrap=d(this.selector.videoWrap);this.el.popCloseBtn=this.el.videoWrap.find(this.selector.popCloseBtn);this.mobileFlag=this.desktopFlag=!1;this.focusLast=this.focusPopup=null};b.prototype.init=function(){this.bindEvents();"desktop"===g.getCurrentDevice()&&(this.setFirst(),this.setImageHeight())};b.prototype.reInit=
function(){this.setElement();this.init()};b.prototype.setImageHeight=function(){this.el.tabNavItem.target.forEach(function(a){function e(){c.css({height:l.outerHeight()+"px"})}a=d(a);var c=a.find(".image"),l=a.find(".image__main");if(0<l.target[0].naturalWidth)e();else l.on("load",function(){e()})})};b.prototype.setFirst=function(){var a=this;this.el.tabItem.target.forEach(function(e,c){e=d(e);0!==c&&(e.hasClass(a.selector.hideCls)||e.addClass(a.selector.hideCls))});this.el.tabNavItem.eq(0).addClass(this.selector.activeCls)};
b.prototype.activeTab=function(a,e){var c=this;this.el.tabItem.target.forEach(function(a,b){a=d(a);b===e?(a.removeClass(c.selector.hideCls),m.setLazyLoad()):a.hasClass(c.selector.hideCls)||a.addClass(c.selector.hideCls)});this.el.tabNavItem.removeClass(this.selector.activeCls);a.addClass(this.selector.activeCls)};b.prototype.initVideo=function(a){var e=this;this.el.videoWrap.target.forEach(function(c){c=d(c);var b=c.find(e.selector.video).target[0];c.attr("id")===a&&(c.addClass(e.selector.videoShowCls),
c.attr("tabindex","0"),c.focus(),0<c.target.length&&g.hiddenScroll(),h.init(b),e.focusPopup=c,e.focusLast=c.find(e.selector.popCloseBtn))});this.el.window.off("keydown",this.handler.focusLock).on("keydown",this.handler.focusLock)};b.prototype.disposeVideo=function(a){a=a.closest(this.selector.videoWrap);var e=a.attr("id"),c=a.find(this.selector.video).target[0];a.removeAttr("tabindex");a.removeClass(this.selector.videoShowCls);g.visibleScroll();h.dispose(c);this.el.videoPlayBtn.target.forEach(function(a){var c=
d(a);a.dataset.videoId===e&&c.focus()});this.el.window.off("keydown",this.handler.focusLock);this.focusLast=this.focusPopup=null};b.prototype.resize=function(){k.MOBILE>g.getViewPort().width?!1===this.mobileFlag&&(this.mobileFlag=!0,this.desktopFlag=!1,this.el.tabItem.removeClass(this.selector.hideCls),this.el.tabNavItem.removeClass(this.selector.activeCls)):(!1===this.desktopFlag&&(this.desktopFlag=!0,this.mobileFlag=!1,this.setFirst()),this.setImageHeight())};b.prototype.bindEvents=function(){var a=
this;this.el.window.off("resize",this.handler.resize).on("resize",this.handler.resize);this.el.tabNavItem.target.forEach(function(e,c){var b=d(e);b.off("click").on("click",function(){a.activeTab(b,c)})});this.el.videoPlayBtn.target.forEach(function(b){var c=d(b),e=b.dataset.videoId;c.off("click").on("click",function(){a.initVideo(e)})});this.el.popCloseBtn.target.forEach(function(b){var c=d(b);c.off("click").on("click",function(){a.disposeVideo(c)})})};var n=function(){d(".gallery-thumbnail-tab").target.length&&
d(".gallery-thumbnail-tab").target.forEach(function(a){b.instances.has(a)||new b(a)})};b.instances=new WeakMap;d.ready(n);window.sg.components.galleryThumbnailTab={init:n,reInit:function(){m.setLazyLoad();d(".gallery-thumbnail-tab").target.forEach(function(a){b.instances.has(a)?b.instances.get(a).reInit():new b(a)})}}})();
(function(d){d(function(){1<d(".gallery-thumbnail-tab").length&&(d(".gallery-thumbnail-tab").each(function(h){var f=d(this),k=f.find(".gallery-thumbnail-tab__play-button");f=f.parent().find(".gallery-thumbnail-tab__video-wrap");k.each(function(){var g=d(this),f=g.attr("data-video-id");g.attr("data-video-id",f+"-"+h)});f.each(function(){var g=d(this),f=g.attr("id");g.attr("id",f+"-"+h)})}),window.sg.components.galleryThumbnailTab.reInit())})})(window.jQuery);