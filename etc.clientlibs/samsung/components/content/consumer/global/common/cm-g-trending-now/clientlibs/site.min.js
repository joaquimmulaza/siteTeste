(function(){function f(a){(a?c(a):c(g.section)).target.forEach(function(a){new b(a)})}var c=window.sg.common.$q,h=window.sg.common.constants.BREAKPOINTS,k=window.sg.common.utils,l=window.sg.common.lazyLoad,m=window.sg.common.utils.isVerticalVisible,e=window.sg.common.swiperManager,g={section:".co69-trending-now"},b=function(a){this.ele={window:c(window),section:c(a),swiperContainer:null};this.selector={swiperWrap:".co69-trending-now__swiper",swiperSlide:".swiper-slide",cardImage:".co69-trending-now__card-image"};
this.swiper=this.mobileFlag=this.desktopFlag=null;this.handler={resize:this.resize.bind(this),scroll:this.handleScroll.bind(this),slideChangeTransitionEnd:this.slideChangeTransitionEnd.bind(this),slideChangeTransitionStart:this.slideChangeTransitionStart.bind(this),slideChangeClick:this.slideChangeClick.bind(this),sliderMove:this.sliderMove.bind(this)};b.instances.set(a,this);this.init()};b.prototype.setProperty=function(){h.MOBILE<k.getViewPort().width?(this.desktopFlag=!0,this.mobileFlag=!1):(this.desktopFlag=
!1,this.mobileFlag=!0);this.ele.swiperSlide=this.ele.section.find(this.selector.swiperSlide);this.ele.swiperWrap.target[0].swiper&&(this.swiper=this.ele.swiperWrap.target[0].swiper)};b.prototype.init=function(){this.setElements();this.slideInit();this.setProperty();this.bindEvents();this.loadImageManually()};b.prototype.setElements=function(){this.ele.swiperContainer=this.ele.section.find(this.selector.swiperWrap)};b.prototype.reInit=function(){this.init()};b.prototype.resize=function(){var a=this;
h.MOBILE<k.getViewPort().width?!1===this.desktopFlag&&(this.desktopFlag=!0,this.mobileFlag=!1,this.setAccessibility()):!1===this.mobileFlag&&(this.mobileFlag=!0,this.desktopFlag=!1,this.setAccessibility());clearTimeout(this.resizeTimer);this.resizeTimer=null;this.resizeTimer=setTimeout(function(){a.swiper.update();a.loadImageManually()},400)};b.prototype.bindEvents=function(){var a=this;this.ele.window.off("resize",this.handler.resize).on("resize",this.handler.resize);this.ele.window.off("scroll",
this.handler.scroll).on("scroll",this.handler.scroll);null!==this.swiper&&(this.swiper.off("click",this.handler.slideChangeClick).on("click",this.handler.slideChangeClick),this.swiper.off("slideChangeTransitionEnd",this.handler.slideChangeTransitionEnd).on("slideChangeTransitionEnd",this.handler.slideChangeTransitionEnd),this.swiper.off("transitionEnd",this.handler.slideChangeTransitionEnd).on("transitionEnd",this.handler.slideChangeTransitionEnd),this.swiper.off("sliderMove",this.handler.sliderMove).on("sliderMove",
this.handler.sliderMove),setTimeout(function(){a.setAccessibility()},400))};b.prototype.isFeatureItemVisible=function(a,b){a=a.getBoundingClientRect();var d=b.getBoundingClientRect();a=d.left>=a.left&&d.left<=a.right||d.right>=a.left&&d.right<=a.right;return m(b)&&a};b.prototype.loadImageManually=function(){var a=this,b=e.getSwiper(this.ele.swiperContainer.target[0]);b.slides.each(function(d,c){a.isFeatureItemVisible(b.el,c)&&l.setLazyLoadManually(c)})};b.prototype.slideInit=function(){var a=this;
this.ele.swiperWrap=this.ele.section.find(this.selector.swiperWrap);this.ele.swiperWrap.target.forEach(function(b){e.getSwiper(b)||(e.slideInit(b),e.slideInitEnd(b,function(){a.swiper=e.getSwiper(b);a.setProperty();a.bindEvents()}))})};b.prototype.sliderMove=function(){this.loadImageManually()};b.prototype.handleScroll=function(){this.loadImageManually()};b.prototype.slideChangeClick=function(a){!1!==this.desktopFlag&&(a=a.target,0<c(a).closest(".swiper-slide").target.length&&"true"===c(a).closest(".swiper-slide").attr("aria-hidden")&&
this.swiper.slideToClickedSlide())};b.prototype.slideChangeTransitionStart=function(){this.ele.swiperWrap.find(".swiper-slide").addClass("changing");this.ele.swiperWrap.find(".swiper-slide").removeClass("changed")};b.prototype.slideChangeTransitionEnd=function(){this.setAccessibility();this.loadImageManually()};b.prototype.setSlideAria=function(a,b){var d=this;a=c(a);!0===b?(a.attr("aria-hidden",!0),a.attr("tabindex",-1),a.find(this.selector.cardImage).target.forEach(function(a){return d.checkFocusable(a)?
c(a).attr("tabindex",-1):!1})):(a.attr("aria-hidden",!1),a.attr("tabindex",0),a.find(this.selector.cardImage).target.forEach(function(a){return d.checkFocusable(a)?c(a).attr("tabindex",0):!1}))};b.prototype.setAccessibility=function(){var a=this,b=this.ele.swiperWrap.offset().left,e=b+this.ele.swiperWrap.outerWidth();this.ele.section.find(this.selector.swiperSlide).target.forEach(function(d){c(d).find(".co69-trending-now__card-image").offset().left<b||c(d).find(".co69-trending-now__card-image").offset().right>
e?a.setSlideAria(d,!0):a.setSlideAria(d,!1)})};b.prototype.checkFocusable=function(a){var b=a.nodeName.toLowerCase();return/^(input|select|textarea|button|object)$/.test(b)?!0:"a"===b?a.hasAttribute("href")?!0:!1:!1};b.instances=new WeakMap;window.sg.components.trendingNow={init:f,reInit:function(a){(a?c(a):c(g.section)).target.forEach(function(a){b.instances.has(a)?b.instances.get(a).reInit():new b(a)})}};c.ready(function(){return f()})})();