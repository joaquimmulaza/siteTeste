(function(){function e(){b(f.section).target.forEach(function(c){new a(c)})}var b=window.sg.common.$q,g=window.sg.common.libs,d=window.sg.common.popupVideo,f={section:".article-header"},a=function(c){this.selector={section:f.section,shareWrap:".article-header__share",shareBtn:".article-header__share-btn",shareLayer:".article-header__share-layer",shareUrl:".share-layer__url-input",shareClose:".share-layer__close",videoOpen:".article-header__btn-play",videoPopup:".popup-video",videoInner:".popup-video__video-wrap",
videoClose:".popup-video__btn-video-close",isActiveCls:"is-active"};this.ele={section:b(c),window:b(window)};this.handler={toggleShareLayer:this.toggleShareLayer.bind(this),outClick:this.outClick.bind(this),outFocus:this.outFocus.bind(this),videoPlay:this.videoPlay.bind(this),videoClose:this.videoClose.bind(this)};a.instances.set(c,this);this.init()};a.prototype.init=function(){this.setProperty();this.bindEvents()};a.prototype.reInit=function(){this.setProperty();this.bindEvents()};a.prototype.setProperty=
function(){this.ele.shareWrap=this.ele.section.find(this.selector.shareWrap);this.ele.shareBtn=this.ele.section.find(this.selector.shareBtn);this.ele.shareLayer=this.ele.section.find(this.selector.shareLayer);this.ele.shareUrl=this.ele.section.find(this.selector.shareUrl);this.ele.shareClose=this.ele.section.find(this.selector.shareClose);this.ele.videoOpen=this.ele.section.find(this.selector.videoOpen);this.ele.videoPopup=this.ele.section.find(this.selector.videoPopup);this.ele.videoInner=this.ele.section.find(this.selector.videoInner);
this.ele.videoClose=this.ele.section.find(this.selector.videoClose)};a.prototype.bindEvents=function(){this.ele.shareBtn.off("click",this.handler.toggleShareLayer).on("click",this.handler.toggleShareLayer);this.ele.shareClose.off("click",this.handler.toggleShareLayer).on("click",this.handler.toggleShareLayer);this.ele.videoOpen.off("click",this.handler.videoPlay).on("click",this.handler.videoPlay);this.ele.videoClose.off("click",this.handler.videoClose).on("click",this.handler.videoClose)};a.prototype.toggleShareLayer=
function(c){var a=this;this.ele.shareWrap.hasClass(this.selector.isActiveCls)?(this.ele.shareBtn.focus(),this.deactiveLayer(this.ele.shareWrap)):(this.activeLayer(),setTimeout(function(){a.ele.shareClose.focus()},300));c.preventDefault()};a.prototype.outFocus=function(c){var a=this;c.keyCode===g.keyCode.TAB_KEY&&this.ele.shareWrap.hasClass(this.selector.isActiveCls)&&(!0===c.shiftKey&&this.ele.shareClose.target[0]===document.activeElement?setTimeout(function(){a.deactiveLayer(a.ele.shareWrap)},80):
!1===c.shiftKey&&this.ele.shareUrl.target[0]===document.activeElement&&this.deactiveLayer(this.ele.shareWrap))};a.prototype.outClick=function(a){(0>=b(a.target).closest(this.selector.shareWrap).target.length||a.target===this.ele.shareWrap.target[0])&&this.ele.shareWrap.hasClass(this.selector.isActiveCls)&&this.deactiveLayer(this.ele.shareWrap)};a.prototype.activeLayer=function(){this.deactiveLayer(b(this.selector.shareWrap));this.ele.shareUrl.target[0].value=window.location.href;this.ele.shareWrap.addClass(this.selector.isActiveCls);
this.ele.shareLayer.css({display:"block"});this.ele.shareBtn.attr("aria-expanded",!0);this.ele.window.off("click",this.handler.outClick).on("click",this.handler.outClick);this.ele.window.off("keydown",this.handler.outFocus).on("keydown",this.handler.outFocus)};a.prototype.deactiveLayer=function(a){a.removeClass(this.selector.isActiveCls);a.find(this.selector.shareLayer).css({display:"none"});this.ele.shareBtn.attr("aria-expanded",!1);this.ele.window.off("click",this.handler.outClick);this.ele.window.off("keydown",
this.handler.outFocus)};a.prototype.videoPlay=function(){this.ele.videoInner.attr("tabindex",0);d.open(this.ele.videoPopup.target[0])};a.prototype.videoClose=function(){this.ele.videoInner.removeAttr("tabindex");this.ele.videoOpen.focus()};a.instances=new WeakMap;window.sg.components.articleHeader={init:e,reInit:function(){b(f.section).target.forEach(function(c){a.instances.has(c)?a.instances.get(c).reInit():new a(c)})}};b.ready(e)})();
(function(){var e=function(b){this.$element=$(b);this.init()};e.prototype.init=function(){this.shareUrlSet()};e.prototype.shareUrlSet=function(){this.$element.find(".share-layer__icon li a").each(function(b){b=$(this);var d=b.attr("data-url");null!==d&&""!==d&&b.attr("href",d)})};var b=$(".article-header");0<b.length&&b.each(function(b,d){new e(d)})})();